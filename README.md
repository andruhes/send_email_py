---
title: send_email.py
description: Программа для автоматической отправки электронной почты по расписанию с Windows Server
author: Ваше имя
version: 1.0
year: 2023
---

## Описание программы

Эта программа предназначена для автоматической отправки электронных писем по заранее установленному расписанию с использованием почтового сервера (SMTP). Скрипт поддерживает работу как с авторизацией на сервере, так и без нее.

### Основные возможности:
- Поддерживает отправку сообщений через SMTP-сервер с/без авторизации.
- Возможность интеграции с планировщиком задач Windows Server для регулярного запуска.

---

## Установка пакетов

Перед началом убедитесь, что установлены нужные зависимости. Для установки пакета `python-dotenv` выполните команду:


pip install python-dotenv

---

Использование
Пример без авторизации на SMTP-сервере
Используйте этот сценарий, если ваша организация позволяет отправлять письма без авторизации на почтовом сервере.


import smtplib
from email.message import EmailMessage

# Почтовые настройки
TO = 'it@andruhes.ru'
FROM = 'napominalka@andruhes.ru'
SUBJECT = 'Напоминание по работе сервера'
BODY = 'Выгрузить из РП ЗУП файл и отправить на почту мне'
SMTP_SERVER = '192.168.100.5'   # адрес вашего SMTP-сервера

# Формирование письма
msg = EmailMessage()
msg['Subject'] = SUBJECT
msg['From'] = FROM
msg['To'] = TO
msg.set_content(BODY)

try:
    # Отправка письма через SMTP-сервер
    with smtplib.SMTP(SMTP_SERVER) as server:
        server.send_message(msg)
    print("Email успешно отправлен!")
except Exception as e:
    print(f"Произошла ошибка при отправке письма: {e}")
Пример с авторизацией на SMTP-сервере
Этот сценарий используется, если необходим вход на сервер с использованием логина и пароля.


import smtplib
from email.message import EmailMessage

# Почтовые настройки
TO = 'it@andruhes.ru'
FROM = 'napominalka@andruhes.ru'
SUBJECT = 'Напоминание по работе сервера'
BODY = 'Выгрузить из РП ЗУП файл и отправить на почту мне'
SMTP_SERVER = '192.168.100.5'     # адрес вашего SMTP-сервера
SMTP_PORT = 587                   # порт SMTP-сервера (обычно 587 для STARTTLS)
USERNAME = 'ВашЛогин'            # ваш логин для авторизации
PASSWORD = 'ВашПароль'           # пароль от аккаунта

# Формирование письма
msg = EmailMessage()
msg['Subject'] = SUBJECT
msg['From'] = FROM
msg['To'] = TO
msg.set_content(BODY)

try:
    # Отправка письма через SMTP-сервер с авторизацией
    with smtplib.SMTP(SMTP_SERVER, SMTP_PORT) as server:
        server.starttls()              # включение зашифрованного соединения TLS
        server.login(USERNAME, PASSWORD)  # авторизация на сервере
        server.send_message(msg)
    print("Email успешно отправлен!")
except Exception as e:
    print(f"Произошла ошибка при отправке письма: {e}")
Запуск по расписанию
Чтобы автоматизировать регулярную отправку писем, добавьте выполнение этого скрипта в Планировщик задач операционной системы Windows Server. Задайте нужный интервал выполнения задания.

Важная информация
Убедитесь, что ваш почтовый сервер разрешает подключение и передачу писем по указанным настройкам.
Если возникают проблемы с подключением, проверьте правильность введенных настроек и наличие необходимой поддержки протокола защиты (например, STARTTLS).
Заключение
Теперь вы можете легко настроить регулярные уведомления сотрудников вашей организации с помощью простого и надежного инструмента на Python!

Лицензия
Данный код распространяется бесплатно и доступен для личного и коммерческого использования без ограничений.

Автор: Ваше имяВерсия: 1.0Год: 2023



Просто вставьте этот текст в файл `README.md`, и всё будет выглядеть аккуратно и понятно.
